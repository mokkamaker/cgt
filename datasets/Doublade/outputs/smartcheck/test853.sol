reorder_contracts_2_3/test853.sol
jar:file:/usr/local/lib/node_modules/@smartdec/smartcheck/jdeploy-bundle/smartcheck-2.0-jar-with-dependencies.jar!/solidity-rules.xmlruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 342
column: 22
content: 0x296Ae1d2D9A8701e113EcdF6cE986a4a7D0A6dC5

ruleId: SOLIDITY_ADDRESS_HARDCODED
patternId: adc165
severity: 1
line: 343
column: 23
content: 0xBC4343B11B7cfdd6dD635f61039b8a66aF6E73Bb

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 10
column: 2
content: self.length+=1

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 382
column: 4
content: games.length+=1

ruleId: SOLIDITY_ARRAY_LENGTH_MANIPULATION
patternId: 872bdd
severity: 1
line: 409
column: 4
content: games.length+=1

ruleId: SOLIDITY_CALL_WITHOUT_DATA
patternId: om991k
severity: 2
line: 562
column: 26
content: call.value(currentBankroll-initialBankroll)()

ruleId: SOLIDITY_CALL_WITHOUT_DATA
patternId: om991k
severity: 2
line: 573
column: 24
content: call.value(profit)()

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 27cb59
severity: 1
line: 554
column: 4
content: suicide

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 27cb59
severity: 1
line: 564
column: 4
content: suicide

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 41
column: 31
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 82
column: 24
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 150
column: 32
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 192
column: 23
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 210
column: 41
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 211
column: 66
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 246
column: 21
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 247
column: 42
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 252
column: 42
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 359
column: 30
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 364
column: 25
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 369
column: 44
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 375
column: 54
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 393
column: 25
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 394
column: 28
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 395
column: 28
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 402
column: 25
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 403
column: 25
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 418
column: 22
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 426
column: 22
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 434
column: 22
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 441
column: 27
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 442
column: 28
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 546
column: 82
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 551
column: 56
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 562
column: 75
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 569
column: 34
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 570
column: 44
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 49bd2a
severity: 1
line: 573
column: 46
content: throw

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 53
column: 1
content: functioncardDescription(uint8self)constantreturns(Suit,uint8){return(Suit(self/cardsPerSuit),cardFacevalue(self));}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 57
column: 1
content: functioncardEmojified(uint8self)constantreturns(uint8,string){stringmemoryemojiSuit;var(suit,number)=cardDescription(self);if(suit==Suit.Clubs)emojiSuit="♣️";elseif(suit==Suit.Diamonds)emojiSuit="♦️";elseif(suit==Suit.Hearts)emojiSuit="♥️";elseif(suit==Suit.Spades)emojiSuit="♠️";return(number,emojiSuit);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 69
column: 1
content: functioncardFacevalue(uint8self)constantreturns(uint8){return1+self%cardsPerSuit;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 73
column: 1
content: functionblackjackValue(uint8self)constantreturns(uint8){uint8cardValue=cardFacevalue(self);returncardValue<10?cardValue:10;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 78
column: 1
content: functiongetRandomNumber(uintb,addressplayer,uint256gameID,uintn,uintm)constantreturns(uint){bytes32blockHash=block.blockhash(b);if(blockHash==0x0)throw;returnuint(uint256(keccak256(blockHash,player,gameID,n))%m);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 166
column: 2
content: functionneedsTick(Gamestorageself)constantreturns(bool){if(self.state==GameState.Waiting)returnfalse;if(self.state==GameState.Finished)returnfalse;returntrue;}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 470
column: 2
content: functiongameState(uinti)constantreturns(uint8[],uint8[],uint8,uint8,uint256,uint256,uint8,uint8,bool,uint256){GameLib.Gamegame=games[i];return(game.houseCards,game.playerCards,GameLib.countHand(game.houseCards),GameLib.countHand(game.playerCards),game.bet,game.payout,uint8(game.state),uint8(game.result),game.closed,game.actionBlock);}

ruleId: SOLIDITY_DEPRECATED_CONSTRUCTIONS
patternId: 28fa69
severity: 1
line: 541
column: 2
content: functionremainingBankroll()constantreturns(uint256){returncurrentBankroll>initialBankroll?initialBankroll:currentBankroll;}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 267
column: 4
content: for(uinti=0;i<hand.length;i++){uint8value=hand[i].blackjackValue();uintl=possibleSums.length;for(uintj=0;j<l;j++){possibleSums[j]+=value;if(value==1){possibleSums=appendArray(possibleSums,possibleSums[j]+10);}}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 283
column: 4
content: for(uinti=0;i<possibleSums.length;i++){if(compareHands(bestSum,possibleSums[i])==ComparaisonResult.Second){bestSum=possibleSums[i];}}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: d3j11j
severity: 1
line: 293
column: 4
content: for(uint8i=0;i<array.length;i++){newArray[i]=array[i];}

ruleId: SOLIDITY_EXTRA_GAS_IN_LOOPS
patternId: k4o1l4
severity: 1
line: 6
column: 2
content: while(self.length>0&&insertingIndex<self.length&&self[insertingIndex]<n){insertingIndex+=1;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 44
column: 2
content: for(uint8i=0;i<cardIndex;i++){if(self.usedCards[i]<=r)r+=1;}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 267
column: 4
content: for(uinti=0;i<hand.length;i++){uint8value=hand[i].blackjackValue();uintl=possibleSums.length;for(uintj=0;j<l;j++){possibleSums[j]+=value;if(value==1){possibleSums=appendArray(possibleSums,possibleSums[j]+10);}}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 270
column: 6
content: for(uintj=0;j<l;j++){possibleSums[j]+=value;if(value==1){possibleSums=appendArray(possibleSums,possibleSums[j]+10);}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 283
column: 4
content: for(uinti=0;i<possibleSums.length;i++){if(compareHands(bestSum,possibleSums[i])==ComparaisonResult.Second){bestSum=possibleSums[i];}}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: f6f853
severity: 2
line: 293
column: 4
content: for(uint8i=0;i<array.length;i++){newArray[i]=array[i];}

ruleId: SOLIDITY_GAS_LIMIT_IN_LOOPS
patternId: 17f23a
severity: 1
line: 6
column: 9
content: self.length>0&&insertingIndex<self.length&&self[insertingIndex]<n

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 41
column: 2
content: if(cardIndex>=totalCards)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 82
column: 2
content: if(blockHash==0x0)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 150
column: 6
content: if(!canDoubleDown(self))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 192
column: 6
content: if(!tick(self))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 210
column: 4
content: if(self.state!=GameState.Waiting)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 211
column: 4
content: if(decision!=GameState.Hit&&decision!=GameState.Stand)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 246
column: 4
content: if(self.closed)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 247
column: 4
content: if(self.state!=GameState.Finished)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 252
column: 6
content: if(!self.player.send(self.payout))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 359
column: 4
content: if(!isOwner[msg.sender])throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 364
column: 4
content: if(msg.sender!=x)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 369
column: 4
content: if(msg.sender!=games[gameID].player)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 375
column: 4
content: if(blockActions[block.number]>maxBlockActions)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 393
column: 4
content: if(!allowsNewGames)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 394
column: 4
content: if(msg.value<minBet)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 395
column: 4
content: if(msg.value>maxBet)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 402
column: 1
content: if(!openedGame.tick())throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 403
column: 1
content: if(!openedGame.closed)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 418
column: 4
content: if(!game.tick())throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 426
column: 4
content: if(!game.tick())throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 434
column: 4
content: if(!game.tick())throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 441
column: 4
content: if(openedGame.closed)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 442
column: 4
content: if(!openedGame.tick())throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 546
column: 4
content: if(initialBankroll>currentBankroll-5ether&&bankrollLockedUntil>now)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 551
column: 6
content: if(!DEV.send(currentBankroll-initialBankroll))throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 562
column: 6
content: if(!ADMIN_CONTRACT.call.value(currentBankroll-initialBankroll)())throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 569
column: 4
content: if(profitsLockedUntil>now)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 570
column: 4
content: if(currentBankroll<=initialBankroll)throw;

ruleId: SOLIDITY_REVERT_REQUIRE
patternId: c56b12
severity: 1
line: 573
column: 4
content: if(!ADMIN_CONTRACT.call.value(profit)())throw;

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 83k1no
severity: 1
line: 562
column: 26
content: call.value(currentBankroll-initialBankroll)()

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 83k1no
severity: 1
line: 573
column: 24
content: call.value(profit)()

ruleId: SOLIDITY_UPGRADE_TO_050
patternId: 901eae
severity: 1
line: 83
column: 22
content: keccak256(blockHash,player,gameID,n)

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 3
column: 1
content: functioninsertInPlace(uint8[]storageself,uint8n){uint8insertingIndex=0;while(self.length>0&&insertingIndex<self.length&&self[insertingIndex]<n){insertingIndex+=1;}self.length+=1;for(uint8i=uint8(self.length)-1;i>insertingIndex;i--){self[i]=self[i-1];}self[insertingIndex]=n;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 33
column: 1
content: functioninit(Deckstorageself,uint256gameID){self.usedCards=newuint8[](0);self.player=msg.sender;self.gameID=gameID;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 39
column: 1
content: functiongetCard(Deckstorageself,uint256blockNumber)returns(uint8){uintcardIndex=self.usedCards.length;if(cardIndex>=totalCards)throw;uint8r=uint8(getRandomNumber(blockNumber,self.player,self.gameID,cardIndex,totalCards-cardIndex));for(uint8i=0;i<cardIndex;i++){if(self.usedCards[i]<=r)r+=1;}self.usedCards.insertInPlace(r);returnr;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 53
column: 1
content: functioncardDescription(uint8self)constantreturns(Suit,uint8){return(Suit(self/cardsPerSuit),cardFacevalue(self));}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 57
column: 1
content: functioncardEmojified(uint8self)constantreturns(uint8,string){stringmemoryemojiSuit;var(suit,number)=cardDescription(self);if(suit==Suit.Clubs)emojiSuit="♣️";elseif(suit==Suit.Diamonds)emojiSuit="♦️";elseif(suit==Suit.Hearts)emojiSuit="♥️";elseif(suit==Suit.Spades)emojiSuit="♠️";return(number,emojiSuit);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 69
column: 1
content: functioncardFacevalue(uint8self)constantreturns(uint8){return1+self%cardsPerSuit;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 73
column: 1
content: functionblackjackValue(uint8self)constantreturns(uint8){uint8cardValue=cardFacevalue(self);returncardValue<10?cardValue:10;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 78
column: 1
content: functiongetRandomNumber(uintb,addressplayer,uint256gameID,uintn,uintm)constantreturns(uint){bytes32blockHash=block.blockhash(b);if(blockHash==0x0)throw;returnuint(uint256(keccak256(blockHash,player,gameID,n))%m);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 92
column: 2
content: functionrecordLog(uint256gameID,addressplayer,uintgameResult,uint256payout,uint8playerHand,uint8houseHand);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 93
column: 2
content: functiontickRequiredLog(uint256gameID,addressplayer,uint256actionBlock);

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 124
column: 2
content: functioninit(Gamestorageself,uint256gameID){self.player=msg.sender;self.bet=msg.value;self.payout=0;self.houseCards=newuint8[](0);self.playerCards=newuint8[](0);self.actionBlock=block.number;self.state=GameState.InitialCards;self.result=GameResult.Ongoing;self.closed=false;self.gameID=gameID;self.deck.init(gameID);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 139
column: 2
content: functiontick(Gamestorageself)returns(bool){if(block.number<=self.actionBlock)returnfalse;if(self.actionBlock+255<block.number){endGame(self,GameResult.House);returntrue;}if(!needsTick(self))returntrue;if(self.state==GameState.InitialCards)dealInitialCards(self);if(self.state==GameState.Hit)dealHitCard(self);if(self.state==GameState.DoubleDown){if(!canDoubleDown(self))throw;self.bet+=msg.value;dealHitCard(self);forceStand(self);}if(self.state==GameState.Stand){dealHouseCards(self);checkGameResult(self);}else{checkGameContinues(self);}returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 166
column: 2
content: functionneedsTick(Gamestorageself)constantreturns(bool){if(self.state==GameState.Waiting)returnfalse;if(self.state==GameState.Finished)returnfalse;returntrue;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 173
column: 2
content: functioncheckGameResult(Gamestorageself){uint8houseHand=countHand(self.houseCards);if(houseHand==target&&self.houseCards.length==2)returnendGame(self,GameResult.House);ComparaisonResultresult=compareHands(houseHand,countHand(self.playerCards));if(result==ComparaisonResult.First)returnendGame(self,GameResult.House);if(result==ComparaisonResult.Second)returnendGame(self,GameResult.Player);endGame(self,GameResult.Tie);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 185
column: 2
content: functioncheckGameContinues(Gamestorageself){uint8playerHand=countHand(self.playerCards);if(playerHand==target&&self.playerCards.length==2)returnendGame(self,GameResult.PlayerNatural);if(playerHand>target)returnendGame(self,GameResult.House);if(playerHand==target){forceStand(self);if(!tick(self))throw;}}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 196
column: 2
content: functionforceStand(Gamestorageself){uint256currentActionBlock=self.actionBlock;playerDecision(self,GameState.Stand);self.actionBlock=currentActionBlock;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 202
column: 2
content: functioncanDoubleDown(Gamestorageself)returns(bool){if(self.playerCards.length>2)returnfalse;uint8totalPlayer=countHand(self.playerCards);if(totalPlayer<9||totalPlayer>11)returnfalse;if(msg.value!=self.bet)returnfalse;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 209
column: 2
content: functionplayerDecision(Gamestorageself,GameStatedecision){if(self.state!=GameState.Waiting)throw;if(decision!=GameState.Hit&&decision!=GameState.Stand)throw;self.state=decision;self.actionBlock=block.number;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 237
column: 2
content: functionendGame(Gamestorageself,GameResultresult){self.result=result;self.state=GameState.Finished;self.payout=payoutForResult(self.result,self.bet);closeGame(self);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 264
column: 2
content: functioncountHand(uint8[]memoryhand)returns(uint8){uint8[]memorypossibleSums=newuint8[](1);for(uinti=0;i<hand.length;i++){uint8value=hand[i].blackjackValue();uintl=possibleSums.length;for(uintj=0;j<l;j++){possibleSums[j]+=value;if(value==1){possibleSums=appendArray(possibleSums,possibleSums[j]+10);}}}returnbestSum(possibleSums);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 281
column: 2
content: functionbestSum(uint8[]possibleSums)returns(uint8bestSum){bestSum=50;for(uinti=0;i<possibleSums.length;i++){if(compareHands(bestSum,possibleSums[i])==ComparaisonResult.Second){bestSum=possibleSums[i];}}return;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 291
column: 2
content: functionappendArray(uint8[]memoryarray,uint8n)returns(uint8[]memory){uint8[]memorynewArray=newuint8[](array.length+1);for(uint8i=0;i<array.length;i++){newArray[i]=array[i];}newArray[array.length]=n;returnnewArray;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 300
column: 2
content: functioncompareHands(uint8a,uint8b)returns(ComparaisonResult){if(a<=target&&b<=target){if(a>b)returnComparaisonResult.First;if(a<b)returnComparaisonResult.Second;}if(a>target&&b>target){if(a<b)returnComparaisonResult.First;if(a>b)returnComparaisonResult.Second;}if(a>target)returnComparaisonResult.Second;if(b>target)returnComparaisonResult.First;returnComparaisonResult.Tie;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 379
column: 2
content: functionBlockjack(address_admin_contract,address_logs_contract){ADMIN_CONTRACT=_admin_contract;blockjacklogs=AbstractBlockjackLogs(_logs_contract);games.length+=1;games[0].init(0);games[0].player=this;setupTrustedAccounts();}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 388
column: 2
content: function()payable{startGame();}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 392
column: 2
content: functionstartGame()blockActionProtectedpayable{if(!allowsNewGames)throw;if(msg.value<minBet)throw;if(msg.value>maxBet)throw;uint256currentGameId=currentGame[msg.sender];if(games.length>currentGameId){GameLib.GameopenedGame=games[currentGameId];if(openedGame.player==msg.sender&&!openedGame.closed){if(!openedGame.tick())throw;if(!openedGame.closed)throw;recordEndedGame(currentGameId);}}uint256newGameID=games.length;games.length+=1;games[newGameID].init(newGameID);currentGame[msg.sender]=newGameID;tickRequiredLog(games[newGameID]);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 415
column: 2
content: functionhit(uint256gameID)onlyPlayer(gameID)blockActionProtected{GameLib.Gamegame=games[gameID];if(!game.tick())throw;game.playerDecision(GameLib.GameState.Hit);tickRequiredLog(game);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 423
column: 2
content: functiondoubleDown(uint256gameID)onlyPlayer(gameID)blockActionProtectedpayable{GameLib.Gamegame=games[gameID];if(!game.tick())throw;game.playerDecision(GameLib.GameState.DoubleDown);tickRequiredLog(game);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 431
column: 2
content: functionstand(uint256gameID)onlyPlayer(gameID)blockActionProtected{GameLib.Gamegame=games[gameID];if(!game.tick())throw;game.playerDecision(GameLib.GameState.Stand);tickRequiredLog(game);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 439
column: 2
content: functiongameTick(uint256gameID)blockActionProtected{GameLib.GameopenedGame=games[gameID];if(openedGame.closed)throw;if(!openedGame.tick())throw;if(openedGame.closed)recordEndedGame(gameID);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 470
column: 2
content: functiongameState(uinti)constantreturns(uint8[],uint8[],uint8,uint8,uint256,uint256,uint8,uint8,bool,uint256){GameLib.Gamegame=games[i];return(game.houseCards,game.playerCards,GameLib.countHand(game.houseCards),GameLib.countHand(game.playerCards),game.bet,game.payout,uint8(game.state),uint8(game.result),game.closed,game.actionBlock);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 496
column: 2
content: functionchangeDev(addressnewDev)only(DEV){isOwner[DEV]=false;DEV=newDev;isOwner[DEV]=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 502
column: 2
content: functionchangeDX(addressnewDX)only(DX){isOwner[DX]=false;DX=newDX;isOwner[DX]=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 508
column: 2
content: functionchangeAdminContract(address_new_admin_contract)only(ADMIN_CONTRACT){isOwner[ADMIN_CONTRACT]=false;ADMIN_CONTRACT=_new_admin_contract;isOwner[ADMIN_CONTRACT]=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 514
column: 2
content: functionsetSettings(uint256_min,uint256_max,uint256_maxBlockActions)only(ADMIN_CONTRACT){minBet=_min;maxBet=_max;maxBlockActions=_maxBlockActions;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 520
column: 2
content: functionregisterOwner(address_new_watcher)only(ADMIN_CONTRACT){isOwner[_new_watcher]=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 524
column: 2
content: functionremoveOwner(address_old_watcher)only(ADMIN_CONTRACT){isOwner[_old_watcher]=false;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 528
column: 2
content: functionstopBlockjack()onlyOwner{allowsNewGames=false;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 532
column: 2
content: functionstartBlockjack()only(ADMIN_CONTRACT){allowsNewGames=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 536
column: 2
content: functionaddBankroll()only(DX)payable{initialBankroll+=msg.value;currentBankroll+=msg.value;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 541
column: 2
content: functionremainingBankroll()constantreturns(uint256){returncurrentBankroll>initialBankroll?initialBankroll:currentBankroll;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 545
column: 2
content: functionremoveBankroll()only(DX){if(initialBankroll>currentBankroll-5ether&&bankrollLockedUntil>now)throw;stopBlockjack();if(currentBankroll>initialBankroll){if(!DEV.send(currentBankroll-initialBankroll))throw;}suicide(DX);contractCleared=true;}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 558
column: 2
content: functionmigrateBlockjack()only(ADMIN_CONTRACT){stopBlockjack();if(currentBankroll>initialBankroll){if(!ADMIN_CONTRACT.call.value(currentBankroll-initialBankroll)())throw;}suicide(DX);}

ruleId: SOLIDITY_VISIBILITY
patternId: 910067
severity: 1
line: 568
column: 2
content: functionshareProfits()onlyOwner{if(profitsLockedUntil>now)throw;if(currentBankroll<=initialBankroll)throw;uint256profit=currentBankroll-initialBankroll;if(!ADMIN_CONTRACT.call.value(profit)())throw;currentBankroll-=profit;bankrollLockedUntil=now+BANKROLL_LOCK_PERIOD;profitsLockedUntil=bankrollLockedUntil+BANKROLL_LOCK_PERIOD;}

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 23
column: 1
content: uint8constantcardsPerSuit=13;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 24
column: 1
content: uint8constantsuits=4;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 25
column: 1
content: uint8constanttotalCards=cardsPerSuit*suits;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 99
column: 2
content: uint8constanthouseLimit=17;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 100
column: 2
content: uint8constanttarget=21;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 319
column: 2
content: AbstractBlockjackLogsblockjacklogs;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 323
column: 2
content: GameLib.Game[]games;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 326
column: 2
content: boolcontractCleared;

ruleId: SOLIDITY_VISIBILITY
patternId: b51ce0
severity: 1
line: 333
column: 2
content: mapping(uint256=>uint256)blockActions;

SOLIDITY_VISIBILITY :53
SOLIDITY_DEPRECATED_CONSTRUCTIONS :39
SOLIDITY_ARRAY_LENGTH_MANIPULATION :3
SOLIDITY_REVERT_REQUIRE :29
SOLIDITY_EXTRA_GAS_IN_LOOPS :4
SOLIDITY_ADDRESS_HARDCODED :2
SOLIDITY_UPGRADE_TO_050 :3
SOLIDITY_GAS_LIMIT_IN_LOOPS :6
SOLIDITY_CALL_WITHOUT_DATA :2

